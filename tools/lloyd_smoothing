#! /usr/bin/env python
# -*- coding: utf-8 -*-
import argparse
import numpy
from matplotlib import pyplot as plt
import pyfvm


def _parse_input_arguments():
    parser = argparse.ArgumentParser(
        description='Perform Lloyd smoothing on a 2D mesh.'
        )

    parser.add_argument(
        'input',
        metavar='INPUT',
        type=str,
        help='Input file'
        )

    parser.add_argument(
        'output',
        metavar='OUTPUT',
        type=str,
        help='Output file'
        )

    parser.add_argument(
        '--tolerance', '-t',
        metavar='TOL',
        type=float,
        required=True,
        help='convergence criterium (maximum move)'
        )

    parser.add_argument(
            '--verbose', '-v',
            dest='verbose',
            action='store_true',
            default=False
            )

    return parser.parse_args()


if __name__ == '__main__':
    args = _parse_input_arguments()
    mesh, _, _, _ = pyfvm.reader.read(args.input)
    out_mesh = pyfvm.mesh_tri.lloyd_smoothing(
        mesh,
        args.tolerance,
        verbose=args.verbose
        )
    out_mesh.write(args.output)
